<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Project new data into an existing t-SNE embedding object. — project • snifter</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Project new data into an existing t-SNE embedding object. — project" />
<meta property="og:description" content="Project new data into an existing t-SNE embedding object." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">snifter</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/snifter.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Alanocallaghan/snifter/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Project new data into an existing t-SNE embedding object.</h1>
    <small class="dont-index">Source: <a href='https://github.com/Alanocallaghan/snifter/blob/master/R/project.R'><code>R/project.R</code></a></small>
    <div class="hidden name"><code>project.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Project new data into an existing t-SNE embedding object.</p>
    </div>

    <pre class="usage"><span class='fu'>project</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>new</span>,
  <span class='va'>old</span>,
  perplexity <span class='op'>=</span> <span class='fl'>5</span>,
  initialization <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"median"</span>, <span class='st'>"weighted"</span>, <span class='st'>"random"</span><span class='op'>)</span>,
  k <span class='op'>=</span> <span class='fl'>25L</span>,
  learning_rate <span class='op'>=</span> <span class='fl'>0.1</span>,
  early_exaggeration <span class='op'>=</span> <span class='fl'>4</span>,
  early_exaggeration_iter <span class='op'>=</span> <span class='fl'>0L</span>,
  exaggeration <span class='op'>=</span> <span class='fl'>1.5</span>,
  n_iter <span class='op'>=</span> <span class='fl'>250L</span>,
  initial_momentum <span class='op'>=</span> <span class='fl'>0.5</span>,
  final_momentum <span class='op'>=</span> <span class='fl'>0.8</span>,
  max_grad_norm <span class='op'>=</span> <span class='fl'>0.25</span>,
  tolerance <span class='op'>=</span> <span class='fl'>1e-04</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>t-SNE embedding created with <code><a href='snifter.html'>fitsne</a></code>.</p></td>
    </tr>
    <tr>
      <th>new</th>
      <td><p>New data to project into existing embedding</p></td>
    </tr>
    <tr>
      <th>old</th>
      <td><p>Data used to create the original embedding.</p></td>
    </tr>
    <tr>
      <th>perplexity</th>
      <td><p>Numeric scalar. Perplexity can be thought of
as the continuous number of nearest neighbors, for which t-SNE
will attempt to preserve distances. However, when projecting,
we only consider neighbors in the existing embedding i.e.
each data point is placed into the embedding, independently
of other new data points.</p></td>
    </tr>
    <tr>
      <th>initialization</th>
      <td><p>Character scalar specifying the method
used to compute the initial point positions to be used in the
embedding space. Can be "median", "weighted" or "random".
In all cases, "median" or "weighted" should be preferred.</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>Integer scalar specifying the number of nearest neighbors to
consider when initially placing the point onto the embedding. This is
different from "perplexity" because perplexity affects
optimization while this only affects the initial point positions.</p></td>
    </tr>
    <tr>
      <th>learning_rate</th>
      <td><p>The learning rate for t-SNE optimization.
When <code>learning_rate="auto"</code> the appropriate learning rate
is selected according to max(200, N / 12), as determined in
Belkina et al. Otherwise, a numeric scalar.</p></td>
    </tr>
    <tr>
      <th>early_exaggeration</th>
      <td><p>Numeric scalar; the exaggeration factor to use
during the *early exaggeration* phase. Typical values range from 12 to
32.</p></td>
    </tr>
    <tr>
      <th>early_exaggeration_iter</th>
      <td><p>The number of iterations to run
in the *early exaggeration* phase.</p></td>
    </tr>
    <tr>
      <th>exaggeration</th>
      <td><p>The exaggeration factor to use during the
normal optimization phase. This can be used to form more densely
packed clusters and is useful for large data sets.</p></td>
    </tr>
    <tr>
      <th>n_iter</th>
      <td><p>The number of iterations to run in the normal
optimization regime.</p></td>
    </tr>
    <tr>
      <th>initial_momentum</th>
      <td><p>The momentum to use during the
*early exaggeration* phase.</p></td>
    </tr>
    <tr>
      <th>final_momentum</th>
      <td><p>The momentum to use during the normal
optimization phase.</p></td>
    </tr>
    <tr>
      <th>max_grad_norm</th>
      <td><p>Maximum gradient norm. If the norm exceeds
this value, it will be clipped. When adding points into an
existing embedding, and the new points
overlap with the reference points, this may lead to large
gradients.
This can make points "shoot off" from the embedding, causing the
interpolation method to compute a very large grid, and leads to
worse results.</p></td>
    </tr>
    <tr>
      <th>tolerance</th>
      <td><p>Numeric scalar specifying the numeric tolerance
used to ensure the affinities calculated on the old data match
those of the original embedding.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Numeric matrix of t-SNE co-ordinates resulting from embedding
 <code>new</code> into the t-SNE embedding <code>x</code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Automated optimized parameters for T-distributed stochastic neighbor
 embedding improve visualization and analysis of large datasets.
 Belkina, A.C., Ciccolella, C.O., Anno, R. et al.
 Nature Communications 10, 5415 (2019).
 doi: <a href='https://doi.org/10.1038/s41467-019-13055-y'>https://doi.org/10.1038/s41467-019-13055-y</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'> <span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>42</span><span class='op'>)</span>
 <span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>2000</span><span class='op'>)</span>, ncol<span class='op'>=</span><span class='fl'>20</span><span class='op'>)</span>
 <span class='va'>out_binding</span> <span class='op'>&lt;-</span> <span class='fu'><a href='snifter.html'>fitsne</a></span><span class='op'>(</span><span class='va'>m</span><span class='op'>[</span><span class='op'>-</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>)</span>, <span class='op'>]</span>, random_state <span class='op'>=</span> <span class='fl'>42L</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>adding rname 'https://repo.anaconda.com/miniconda/Miniconda3-py37_4.8.2-MacOSX-x86_64.sh'</span></div><div class='input'> <span class='va'>new_points</span> <span class='op'>&lt;-</span> <span class='fu'>project</span><span class='op'>(</span><span class='va'>out_binding</span>, new <span class='op'>=</span> <span class='va'>m</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span>, <span class='op'>]</span>, old <span class='op'>=</span> <span class='va'>m</span><span class='op'>[</span><span class='op'>-</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>)</span>, <span class='op'>]</span><span class='op'>)</span>
 <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>out_binding</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='st'>"black"</span>, pch <span class='op'>=</span> <span class='fl'>19</span>,
     xlab <span class='op'>=</span> <span class='st'>"t-SNE 1"</span>, ylab <span class='op'>=</span> <span class='st'>"t-SNE 2"</span><span class='op'>)</span>
</div><div class='input'> <span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>new_points</span>, col <span class='op'>=</span> <span class='st'>"red"</span>, pch <span class='op'>=</span> <span class='fl'>19</span><span class='op'>)</span>
</div><div class='img'><img src='project-1.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alan O'Callaghan, Aaron Lun.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


